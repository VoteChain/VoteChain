{
  "components": {
    "components/widget/AdminHome": {
      "code": "// Get the user's accountId\nconst accountId = context.accountId;\n\n// Declaring variables\n// !!!\nconst voteId = props.vote && parseFloat(props.vote);\n// const voteId = 113225718;\n\n// All the votes\nconst allVotes = Social.index(\"voteChainTest\", \"vote\")\n  ? Social.index(\"voteChainTest\", \"vote\")\n  : [];\nconst otherCandidates = Social.index(\"voteChainTest\", \"candidate\")\n  ? Social.index(\"voteChainTest\", \"candidate\")\n  : [];\nconst otherParties = Social.index(\"voteChainTest\", \"party\")\n  ? Social.index(\"voteChainTest\", \"party\")\n  : [];\nconst votes = Social.index(\"voteChainTest\", \"votes\")\n  ? Social.index(\"voteChainTest\", \"votes\")\n  : [];\n\n// Set the value of votetorender by adding other parties and candidates to it\nfunction getValue() {\n  console.log(otherCandidates, \"this\");\n  var temp = allVotes.find((vote) => vote.blockHeight === voteId);\n  var votesOnThis = votes.filter((vote) => vote.value.voteId === voteId);\n  return {\n    ...temp,\n    value: {\n      ...temp.value,\n      parties: temp.value.parties.concat(\n        otherParties\n          .filter(\n            (party) =>\n              party.value.voteId === voteId &&\n              party.value.name &&\n              party.value.acronym\n          )\n          .map((party) => ({\n            name: party.value.name,\n            acronym: party.value.acronym,\n          }))\n      ),\n      candidates: temp.value.candidates\n        .concat(\n          // Add other candidates to the list of all candidates\n          otherCandidates\n            .filter(\n              (candidate) =>\n                // Get only the candidates of the vote and vreified\n                candidate.value.voteId === voteId &&\n                candidate.value.name &&\n                candidate.value.party &&\n                candidate.value.role\n            )\n            .map((c) => c.value)\n        )\n        .map(\n          // This put the number of votes of the candidate\n          (cand, i) => ({\n            ...cand,\n            votes: votesOnThis.filter((vote) => vote.value.party === cand.party)\n              .length,\n          })\n        ),\n      voters: votesOnThis.map((vote) => vote.value.by),\n    },\n  };\n}\nconst [voteToRender, setVoteToRender] = useState(getValue());\n\n// Get all the votes\nuseEffect(() => {\n  // Set the vote to be rendered\n  setVoteToRender(getValue());\n  console.log(voteToRender, allVotes, \"votesData\");\n}, [allVotes]);\n\n// Pages that will be displayed in the aside\nconst [pages, setPages] = useState([]);\n\n// Add admin pages if the user is the creator of the vote\nuseEffect(() => {\n  if (voteToRender.value.creator === accountId) {\n    setPages([\n      {\n        name: \"Voting Page\",\n        link: `https://near.social/abnakore.near/widget/App.jsx?vote=${voteToRender.blockHeight}`,\n      },\n      {\n        name: \"Result\",\n        link: `https://near.social/abnakore.near/widget/Result.jsx?vote=${voteToRender.blockHeight}`,\n      },\n      {\n        name: \"Admin Home\",\n        link: `https://near.social/abnakore.near/widget/AdminHome?vote=${voteToRender.blockHeight}`,\n      },\n      {\n        name: \"Manage Candidates\",\n        link: `https://near.social/abnakore.near/widget/ManageCandidates?vote=${voteToRender.blockHeight}`,\n      },\n      {\n        name: \"Mange Parties\",\n        link: `https://near.social/abnakore.near/widget/ManageParties?vote=${voteToRender.blockHeight}`,\n      },\n    ]);\n  } else {\n    setPages([\n      {\n        name: \"Voting Page\",\n        link: `https://near.social/abnakore.near/widget/App.jsx?vote=${voteToRender.blockHeight}`,\n      },\n      {\n        name: \"Result\",\n        link: `https://near.social/abnakore.near/widget/Result.jsx?vote=${voteToRender.blockHeight}`,\n      },\n    ]);\n  }\n}, [voteToRender.value.creator === accountId]);\n\nreturn (\n  <>\n    {accountId ? (\n      <Widget\n        src=\"abnakore.near/widget/Wrapper\"\n        props={{\n          body: (\n            <div className=\"main-body\">\n              {voteToRender ? (\n                voteToRender.value.creator === accountId ? (\n                  <div className=\"two-sides\">\n                    <Widget\n                      src=\"abnakore.near/widget/Aside\"\n                      props={{ objs: pages, active: \"/admin\" }}\n                    />\n                    {voteToRender.value.creator === accountId ? (\n                      <div className=\"body-contents\">\n                        <h1>Admin Home</h1>\n                        <h4>Candidates Details</h4>\n                        <Widget\n                          src=\"abnakore.near/widget/Table\"\n                          props={{\n                            headings: [\n                              \"S/N\",\n                              \"Candidate's Name\",\n                              \"Party\",\n                              \"Role\",\n                              \"Number of votes\",\n                            ],\n                            data: Object.values(\n                              voteToRender.value.candidates\n                                .sort((a, b) => a.votes - b.votes)\n                                .map((c, i) =>\n                                  [i + 1].concat([\n                                    c.name,\n                                    c.party,\n                                    c.role,\n                                    c.votes,\n                                  ])\n                                )\n                            ),\n                          }}\n                        />\n\n                        <a\n                          href={`https://near.social/abnakore.near/widget/ManageCandidates?vote=${voteToRender.blockHeight}`}\n                        >\n                          <button>Add Candidate</button>\n                        </a>\n                        <hr />\n                        <h4>Parties Details</h4>\n                        <Widget\n                          src=\"abnakore.near/widget/Table\"\n                          props={{\n                            headings: [\"S/N\", \"Party Name\", \"Acronym\"],\n                            data: Object.values(\n                              voteToRender.value.parties.map((p, i) =>\n                                [i + 1].concat(Object.values(p))\n                              )\n                            ),\n                          }}\n                        />\n\n                        <a\n                          href={`https://near.social/abnakore.near/widget/ManageParties?vote=${voteToRender.blockHeight}`}\n                        >\n                          <button>Add Party</button>\n                        </a>\n                        <hr />\n                      </div>\n                    ) : (\n                      <div className=\"body-contents\">\n                        <h1>Can not access this page</h1>\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"body-contents\">\n                    <h1>You don't have access to this page</h1>\n                    <a href=\"https://near.social/abnakore.near/widget/VoteChain\">\n                      Back to Home Page\n                    </a>\n                  </div>\n                )\n              ) : (\n                <div className=\"body-contents\">\n                  <h1>Vote Doesn't exist</h1>\n                </div>\n              )}\n            </div>\n          ),\n        }}\n      />\n    ) : (\n      <Widget src=\"abnakore.near/widget/SignIn.jsx\" />\n    )}\n  </>\n);\n"
    }
  }
}